# This script requires csvkit (https://csvkit.readthedocs.io/en/latest/)
# This version of the script worked for the 2006-2010 dataset but is not guaranteed to work for others, depending
# on any column name or ordering changes. Please confirm the correct columns are being used by checking the dataset metadata 
# file before using this script. 

cp b19037.csv b19037.csv.backup
csvcut -c GISJOIN,STATEA,COUNTYA,TRACTA,BLKGRPA,JO2M002,JO2M019,JO2M036,JO2M053 b19037.csv > b19037.csv
b19037_header="GISJOIN,STATEA,COUNTYA,TRACTA,BLKGRPA,under_25,from_25_to_44,from_45_to_64,above_65"
sed -i '' "1s/.*/$b19037_header/" b19037.csv

cp b03002.csv b03002.csv.backup
csvcut -c GISJOIN,STATEA,COUNTYA,TRACTA,BLKGRPA,JMJE003,JMJE004,JMJE005,JMJE006,JMJE007,JMJE008,JMJE009,JMJE012 b03002.csv > b03002.csv
b03002_header="GISJOIN,STATEA,COUNTYA,TRACTA,BLKGRPA,not_hispanic_or_latino_white_alone,not_hispanic_or_latino_black_or_african_american_alone,not_hispanic_or_latino_american_indian_and_alaska_native_alone,not_hispanic_or_latino_asian_alone,not_hispanic_or_latino_native_hawaiian_and_other_pacific,not_hispanic_or_latino_some_other_race_alone,not_hispanic_or_latino_two_or_more_races,hispanic__or__latino"
sed -i '' "1s/.*/$b03002_header/" b03002.csv

cp b16004.csv b16004.csv.backup
csvcut -c GISJOIN,STATEA,COUNTYA,TRACTA,BLKGRPA,JOBE002,JOBE003,JOBE004,JOBE005,JOBE006,JOBE007,JOBE008,JOBE009,JOBE010,JOBE011,JOBE012,JOBE013,JOBE014,JOBE015,JOBE016,JOBE017,JOBE018,JOBE019,JOBE020,JOBE021,JOBE022,JOBE023,JOBE024,JOBE025,JOBE026,JOBE027,JOBE028,JOBE029,JOBE030,JOBE031,JOBE032,JOBE033,JOBE034,JOBE035,JOBE036,JOBE037,JOBE038,JOBE039,JOBE040,JOBE041,JOBE042,JOBE043,JOBE044,JOBE045,JOBE046,JOBE047,JOBE048,JOBE049,JOBE050,JOBE051,JOBE052,JOBE053,JOBE054,JOBE055,JOBE056,JOBE057,JOBE058,JOBE059,JOBE060,JOBE061,JOBE062,JOBE063,JOBE064,JOBE065,JOBE066,JOBE067 b16004.csv > b16004.csv
b16004_header="GISJOIN,STATEA,COUNTYA,TRACTA,BLKGRPA,from_5_to_17_years,from_5_to_17_years_speak_only_english,from_5_to_17_years_speak_spanish,from_5_to_17_years_speak_spanish_very_well,from_5_to_17_years_speak_spanish_well,from_5_to_17_years_speak_spanish_not_well,from_5_to_17_years_speak_spanish_not_at_all,from_5_to_17_years_speak_indo_european,from_5_to_17_years_speak_indo_european_very_well,from_5_to_17_years_speak_indo_european_well,from_5_to_17_years_speak_indo_european_not_well,from_5_to_17_years_speak_indo_european_not_at_all,from_5_to_17_years_speak_asian_and_pacific_island,from_5_to_17_years_speak_asian_and_pacific_island_very_well,from_5_to_17_years_speak_asian_and_pacific_island_well,from_5_to_17_years_speak_asian_and_pacific_island_not_well,from_5_to_17_years_speak_asian_and_pacific_island_not_at_all,from_5_to_17_years_speak_other,from_5_to_17_years_speak_other_very_well,from_5_to_17_years_speak_other_well,from_5_to_17_years_speak_other_not_well,from_5_to_17_years_speak_other_not_at_all,from_18_to_64_years,from_18_to_64_years_speak_only_english,from_18_to_64_years_speak_spanish,from_18_to_64_years_speak_spanish_very_well,from_18_to_64_years_speak_spanish_well,from_18_to_64_years_speak_spanish_not_well,from_18_to_64_years_speak_spanish_not_at_all,from_18_to_64_years_speak_indo_european,from_18_to_64_years_speak_indo_european_very_well,from_18_to_64_years_speak_indo_european_well,from_18_to_64_years_speak_indo_european_not_well,from_18_to_64_years_speak_indo_european_not_at_all,from_18_to_64_years_speak_asian_and_pacific_island,from_18_to_64_years_speak_asian_and_pacific_island_very_well,from_18_to_64_years_speak_asian_and_pacific_island_well,from_18_to_64_years_speak_asian_and_pacific_island_not_well,from_18_to_64_years_speak_asian_and_pacific_island_not_at_all,from_18_to_64_years_speak_other,from_18_to_64_years_speak_other_very_well,from_18_to_64_years_speak_other_well,from_18_to_64_years_speak_other_not_well,from_18_to_64_years_speak_other_not_at_all,from_64_to_over,from_64_to_over_speak_only_english,from_64_to_over_speak_spanish,from_64_to_over_speak_spanish_very_well,from_64_to_over_speak_spanish_well,from_64_to_over_speak_spanish_not_well,from_64_to_over_speak_spanish_not_at_all,from_64_to_over_speak_indo_european,from_64_to_over_speak_indo_european_very_well,from_64_to_over_speak_indo_european_well,from_64_to_over_speak_indo_european_not_well,from_64_to_over_speak_indo_european_not_at_all,from_64_to_over_speak_asian_and_pacific_island,from_64_to_over_speak_asian_and_pacific_island_very_well,from_64_to_over_speak_asian_and_pacific_island_well,from_64_to_over_speak_asian_and_pacific_island_not_well,from_64_to_over_speak_asian_and_pacific_island_not_at_all,from_64_to_over_speak_other,from_64_to_over_speak_other_very_well,from_64_to_over_speak_other_well,from_64_to_over_speak_other_not_well,from_64_to_over_speak_other_not_at_all"
sed -i '' "1s/.*/$b16004_header/" b16004.csv

cp b17021.csv b17021.csv.backup
csvcut -c GISJOIN,STATEA,COUNTYA,TRACTA,BLKGRPA,JOGE002,JOGE019 b17021.csv > b17021.csv
b17021_headers="GISJOIN,STATEA,COUNTYA,TRACTA,BLKGRPA,below_poverty_total,above_poverty_total"
sed -i '' "1s/.*/$b16004_header/" b17021.csv

cp b18101.csv b18101.csv.backup
csvcut -c GISJOIN,STATEA,COUNTYA,TRACTA,RA1E004,RA1E005,RA1E007,RA1E008,RA1E010,RA1E011,RA1E013,RA1E014,RA1E016,RA1E017,RA1E019,RA1E020,RA1E023,RA1E024,RA1E026,RA1E027,RA1E029,RA1E030,RA1E032,RA1E033,RA1E035,RA1E036,RA1E038,RA1E039 b18101.csv > b18101.csv
b18101_headers="GISJOIN,STATEA,COUNTYA,TRACTA,male_under_5_with_disability,male_under_5_no_disability,male_5_to_17_with_disability,male_5_to_17_no_disability,male_18_to_34_with_disability,male_18_to_34_no_disability,male_35_to_64_with_disability,male_35_to_64_no_disability,male_65_to_74_with_disability,male_65_to_74_no_disability,male_over_75_with_disability,male_over_75_no_disability,female_under_5_with_disability,female_under_5_no_disability,female_5_to_17_with_disability,female_5_to_17_no_disability,female_18_to_34_with_disability,female_18_to_34_no_disability,female_35_to_64_with_disability,female_35_to_64_no_disability,female_65_to_74_with_disability,female_65_to_74_no_disability,female_over_75_with_disability,female_over_75_no_disability"
sed -i '' "1s/.*/$b18101_header/" b18101.csv
